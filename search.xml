<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[JavaScript中的时间]]></title>
      <url>/2016/10/30/time-in-javascript/</url>
      <content type="html"><![CDATA[<p>我们在编程时，不可避免地会和时间打交道。 比如要完成一次秒杀活动， 就会涉及到时间存取，时间同步和时间差值计算等诸多细节。一个JavsScript的简单例子，当我们在浏览器控制台输入<code>new Date()</code>, 会得到如下结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Sun Oct 30 2016 16:27:04 GMT+0800 (CST)</div></pre></td></tr></table></figure>
<p>输出前半部分的含义很容易理解， 它代表的是2016年10月30日 星期日，下午16点27分04秒， 后半部分的<code>GMT</code>,<code>+0800</code>, <code>CST</code>到底代表什么呢， 本着一探究竟的想法， 本文来带大家详细了解下JS中的时间。</p>
<h2 id="1-时间的表示"><a href="#1-时间的表示" class="headerlink" title="1.时间的表示"></a>1.时间的表示</h2><p>在古代， 天文学的一个最重要任务就是度量时间，制定历法。我国古代将一年分为十二月、二十四节气,一天分为十二个时辰，目的就是为了一套高效的时间表示方法用以指导农耕。随着现代社会的发展，时间的表示也需要一套更加科学而精确的方法。</p>
<h3 id="度量"><a href="#度量" class="headerlink" title="度量"></a>度量</h3><h4 id="从计时工具说起"><a href="#从计时工具说起" class="headerlink" title="从计时工具说起"></a>从计时工具说起</h4><p>远古时代，人类是根据太阳与地球的角度变化来作息的， 人们都是日出而作， 日落而息， 人类一直遵循着这种延续下来的作息规律。这时的人们对于时间没有什么特别的概念，也不用计时工具。</p>
<p>在中国周代，人们将一天分为12个时辰：子、丑、寅、卯、辰、巳、午、未、申、酉、戊、亥，分别对应夜半、鸡鸣、平旦、日出、食时、隅中、日中、日昳、晡时、日入、黄昏、人定。用来指导人们一天的生活规律。这时，我们用沙漏、日晷来记录大致的时间，可以区别出来的最短时间是1个时辰（2h）。</p>
<p>后来，工业革命将人类带入了工业时代，此时人们对于时间有了更精细的划分，一天被分为12个小时， 每小时60分， 每分60秒。为了更高效地生产，我们用钟表来记录时间，我们对于时间的利用也达到了秒级。</p>
<p>而现在，我们的计时工具已经升级成了冷原子钟。 比如我国的北斗导航卫星系统使用的就是原子钟来记录时间，其计时精度已经达到纳秒级别（1ns=10^-9s）。我们已将空间和时间结合到了一起，可以通过时间来推算空间，在空间中转换时间。</p>
<blockquote>
<p>ps: 曾经在园区听过中科院博导徐颖关于北斗的演讲， 不禁为人类的创造力和中国的强大国力所折服。</p>
</blockquote>
<p>随着人类文明的进步，计时工具也在不断地发展。借助这些工具，人类对于时间的划分越来越细， 对于时间资源的利用率也越来越高。 </p>
<h4 id="时间单位"><a href="#时间单位" class="headerlink" title="时间单位"></a>时间单位</h4><p>我们用时间单位来表达特定的时间间隔，常用的时间单位如： 世纪、年、季度、月、日、小时、分、 秒、 毫秒、微妙、纳秒等。当前人类可以测量的最短的时间单位是<a href="https://zh.wikipedia.org/zh-cn/%E9%98%BF%E7%A7%92" target="_blank" rel="external">阿秒</a>（attosecond），为中性π介子的寿命， 相当于10^-18 秒。</p>
<p>可以说，人们时间的细分过程和标准制定过程，其实是人类探索时间，利用时间的过程。 我们对于时间单位的认知，可以从侧面反映我们对自身所处的时空的认知。时间单位也折射出人类科学文明的发展历程。</p>
<h3 id="时刻"><a href="#时刻" class="headerlink" title="时刻"></a>时刻</h3><p>我们平时常说，现在9点钟了， 其实指的就是时刻。我们要表达的是当前已经达到9点这个时间点了。它是既没有大小也没有方向的，它只表达一个具体的时间点。<br>就好比我们用尺子来衡量长度， 我们也在用一把标记着秒，小时的“尺子”来衡量时间。而时刻，只是我们都可理解的尺子上的某一个刻度。唯一的差别是， 空间中的长度通常是不变的， 而时间永远是在是不可逆地增加的。 </p>
<h2 id="2-时间标准化"><a href="#2-时间标准化" class="headerlink" title="2. 时间标准化"></a>2. 时间标准化</h2><p>首先，我们应认识到，在整个宇宙中， 时间是统一的。 从宇宙的诞生到现在， 总是可以用一个特定的时间间隔值来表示我们所经历的时间，它是一个固定的值。 那么我们不禁会问为什么会说我们这儿是早上9点，而英国那边确是凌晨1点呢，这不是两个不同的时间吗？这就要引出我们下面将提到的时间标准问题。</p>
<p>在以前，人类的活动范围相对狭小，基本不会注意到时区对于人类作息的影响。我们完全想象不到， 当我们在阳光下辛勤劳作的时候， 地球另一面的人们早已进入梦乡。</p>
<p>但是工业革命之后，人类的生产和交通工具不断进步，全球化协作成为不可阻挡的潮流。 此时人们已经意识到了地球在不停地自西向东自转， 自转一周则为一日。而不同经度的地区日出的时间是有先后差异的。比如中国北京还是正午的时候，大洋彼岸的美国纽约正好是深夜。早上8点我们一个电话打过去， 说美国的XXX， 该上班了， 对方一定是一脸的迷(meng)茫(bi), 我这准备洗洗睡呢。</p>
<p>正是人们认识到地球自转的天文规律，才需要制定一套全球统一的时间标准，这样，我们根据本地时间就可以推算出地球任何地区的当地时间（日出日落时间），以方便进行更好的协作。</p>
<h3 id="格林尼治平时（Greenwich-Mean-Time，-GMT）"><a href="#格林尼治平时（Greenwich-Mean-Time，-GMT）" class="headerlink" title="格林尼治平时（Greenwich Mean Time， GMT）"></a>格林尼治平时（Greenwich Mean Time， GMT）</h3><p>格林尼治是位于英国伦敦郊区的皇家格里尼治天文台， 我们经常说的格林尼治时间指的就是以此地的时间为标准时间制定的一套时间计量系统。</p>
<p>为了准确地表示各地时间，1884年，国际经度会议决定将通过英国格林尼治天文埃里中星仪的经线定为计算经度的起算经线，称为本初子午线。以本初子午线的平子夜起算的平太阳时，分别向东、西计量增减12时，作为统一的时间标准，称为格林尼治平时。这也就是GMT时间的由来，它是根据地球的自转所定义的一套时间标准，其对于日常生活， 天文导航和宇宙飞行等人类活动具有重要作用。</p>
<p>GMT的制定同时也产生了时区的概念。我们在听关于国外的新闻报道的时候，经常会听到于当地时间XX时XX分，本地时间yy时yy分发生了什么大事，然后是balabala。 这其实就是在时间的表示上避免位于不同时区的人对于时间理解的差异。</p>
<p>时区(Time Zone)， 设定了一个区域的标准时间。 理论上， 以被15整除的子午线为中心， 向东西各延伸7.5经度，划分为一个时区。实际上，由于各个国家的版图不规则， 通常会跨越多个时区， 所以国家内部还会规定整个行政区域内的一个实际时区，称为法定时区。比如中国， 从西到东横跨东五、东六、东七、东八和东九五个时区， 中华人民共和国成立以后，全国统一采用首都北京所在的东八时区的区时作为标准时间，称为北京时间。</p>
<h3 id="协调世界时（Coordinated-Universal-Time，-UTC）"><a href="#协调世界时（Coordinated-Universal-Time，-UTC）" class="headerlink" title="协调世界时（Coordinated Universal Time， UTC）"></a>协调世界时（Coordinated Universal Time， UTC）</h3><p>UTC通常被误认为是GMT， 其实两者的表示方法完全不同。</p>
<h4 id="UTC的由来"><a href="#UTC的由来" class="headerlink" title="UTC的由来"></a>UTC的由来</h4><p>人类观测到地球自转的缓慢下降，地球自转一周耗时经过一段时间后会多于现行的24小时，因此GMT时间已不再适合作为标准时间使用。现在的标准时间是由原子钟报时的协调世界时，这是由国际计量局和国际地球自转服务（IERS）维护的时间标度，是各标准频率和时间信号协协调播发基准。</p>
<p>那为什么又要搞个UTC呢，太乱了吧? 其实谁也不想这么麻烦， 这是地球自己“转”出来的。</p>
<p>我们常识性认为地球自转一周是24小时，而由于地球自转速度变慢，在经过了24h之后，地球可能还没有成一周的运转， 为了保证24h和地球完整的一周相匹配，就必须让钟表上的时间等待地球自转一周完成，这就是协调世界时中“协调”二字的含义。UTC时间相较于<code>国际原子钟时间（International Atomic Time, TAI）</code>实际是要慢的。</p>
<blockquote>
<p>注：秒是基本的时间国际单位，国际上现在标准的1秒为：铯133原子基态的两个超精细能级间跃迁对应的辐射的9,192,631,770个周期的持续时间</p>
</blockquote>
<p>说白了，TAI时间是基于原子规律定义的时间，这个时间长时间不会变化。UTC是为了符合地球自转周期所制定的时间， UTC会让全球的钟表都停下来，补上地球自转变慢的差值， 而矫正和同步机构就是IERS。全球所有国家根据UTC时间和各自国家所在的时区确定当地时间，以此来保证全球时间的低误差同步。 </p>
<h4 id="闰秒"><a href="#闰秒" class="headerlink" title="闰秒"></a>闰秒</h4><p>UTC以加入闰秒（leap-secons）的方式对时间进行修正，以消除地球自转变慢的影响。闰秒是为了平衡因地球自转变慢所引起的和原子钟的时间差而特意设置的。如果不加入闰秒，可能过几万年之后，中午的12点会变成凌晨0点； 再过个几百万年，日历上的冬天会变成了夏天了，那么整个生产生活就会乱套了。</p>
<p>闰秒的引入时机是每年的6月和12月月末， 视UTC-TAI的演变差值而定，并且每隔六个月会公布是否需要加入闰秒（这就是IERS干的活儿）。</p>
<p>上次闰秒的引入时间是<code>UTC 2015-6-30 23:59:60</code>  而下一次的闰秒引入会在：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2016-12-31 23:59:59</div><div class="line">2016-12-31 23:59:60</div><div class="line">2017-01-01 00:00:00</div></pre></td></tr></table></figure></p>
<p>从2015-07-01 00:00:00 UTC  到  2017-01-01 00:00:00 UTC 时间差异是： UTC - TAI = -36s. 也就是说，我们的UTC时间标准相较于真正的原子钟时间，人为地慢了36秒。</p>
<blockquote>
<p>PS1: 是不是感觉自己赚到了， 多活了36s呢！<br>PS2: 人类当前所用的时间大多都已经是UTC时间了， 但是很多时候还保留着GMT的时区划分规则，所以很多地方显示的还是GMT时间。</p>
</blockquote>
<h3 id="北京时间（China-Standard-Time-CST"><a href="#北京时间（China-Standard-Time-CST" class="headerlink" title="北京时间（China Standard Time, CST)"></a>北京时间（China Standard Time, CST)</h3><p>再来说一下我国的时间基准， 北京时间不是在北京确定的，而是由位于中国版图几何中心位置陕西临潼和陕西蒲城的中国科学院国家授时中心（国家授时台）的9台铯原子钟（铯钟）和2台氢原子钟组通过精密比对和计算实现，并通过卫星与世界各国授时部门进行实时比对确定的。国内的设备可以通过国家授时中心提供的NTP(Network Time Protocol)服务器和本地时间进行同步。具体使用可以参看<a href="http://www.pool.ntp.org/en/use.html" target="_blank" rel="external">此处</a>。</p>
<p>在Mac上， 可以通过如下命令和制定的NTP服务器进行校时：</p>
<blockquote>
<p>➜  ~ sudo ntpdate -u cn.pool.ntp.org<br>1 Nov 03:20:08 ntpdate[84376]: adjust time server 59.46.44.253 offset 0.014804 sec<br>➜  ~</p>
</blockquote>
<h2 id="3-小结"><a href="#3-小结" class="headerlink" title="3. 小结"></a>3. 小结</h2><p>再回到文章最开始所提到的, <code>new Date()</code>在输出数据， 所有的内容就清晰了:</p>
<ul>
<li><code>GMT</code>, 代表的格林尼治平时，但此处的GMT所表示的意思是：时间使用的时区是GMT标准，时间采用的是UTC时间</li>
<li><code>+0800</code> 代表的是当前时间和标准时间的时差， 精确到分。+0800， 表示当前时间早于UTC时间8小时整</li>
<li><code>CST</code> 指的是北京时间</li>
</ul>
<p>done!</p>
<h2 id="4-后记"><a href="#4-后记" class="headerlink" title="4. 后记"></a>4. 后记</h2><p>一门程序设计语言中有很多细节， 往往蕴含着极大的智慧。以本文提到的时间为例， 几个简单的单词， 其中蕴含了人类近几百年的科技文明发展成果，也反映了人类对于时间的尊重和敬畏，每一处都值得细细品味。</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] 闰秒（leap seconds）: <a href="http://tycho.usno.navy.mil/leapsec.html" target="_blank" rel="external">http://tycho.usno.navy.mil/leapsec.html</a><br><a href="https://hpiers.obspm.fr/iers/bul/bulc/bulletinc.dat" target="_blank" rel="external">https://hpiers.obspm.fr/iers/bul/bulc/bulletinc.dat</a><br>[2] 日期和时间表示法（国标 GB/T 7408-2005) <a href="http://www.cmaph.org/attachment/2013530/1369881489484.pdf" target="_blank" rel="external">http://www.cmaph.org/attachment/2013530/1369881489484.pdf</a><br>[3] 24小时制： <a href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%B0%8F%E6%99%82%E5%88%B6" target="_blank" rel="external">https://zh.wikipedia.org/wiki/%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%B0%8F%E6%99%82%E5%88%B6</a><br>[4]时间： <a href="https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4" target="_blank" rel="external">https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[配置git open命令快速打开Git项目主页]]></title>
      <url>/2016/10/24/git-open/</url>
      <content type="html"><![CDATA[<p><code>Git</code>目前已经成为大量程序员管理项目版本的工具，程序猿在开发代码的时候， 总是希望做到沉浸式开发，不希望过多的事儿打扰。 而我们在使用Git作为版本办理工具进行开发的时候， 通常会遇到的情况是：需要频繁地在本地终端和线上git上进行切换。</p>
<p>试想一下如下场景，是否经常让人抓狂：</p>
<ul>
<li>本地push了一次新的提交，需要看看线上是否更新了</li>
<li>我刚接受一个项目，项目名很长，很难记， 每次要查看项目主页，地址好难敲, 如：<a href="http://gitlab.xxx.com/group-xxx/project-xxx" target="_blank" rel="external">http://gitlab.xxx.com/group-xxx/project-xxx</a></li>
<li>…</li>
</ul>
<p>那么，<code>git-open</code>命令可以解决你的大部分烦恼。</p>
<p>我们期望的方式： 在终端的项目文件夹内， 通过一条命令， 可以直接唤起浏览器打开本地git项目对应的远程项目主页。经本人测试， <a href="https://www.npmjs.com/package/git-open" target="_blank" rel="external">git-open</a>可以满足我们的需求。</p>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p>在项目文件夹下， 直接运行:</p>
<blockquote>
<p>git open</p>
</blockquote>
<p>打开效果：<br><img src="http://p1.bpimg.com/567571/c9e3660df0dff2ed.png" alt=""></p>
<p>是不是很流畅啊， 再也不用傻子似的打开浏览器凭着自己惊人的记忆力输项目地址了。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先，你需要安装<code>node</code>， <code>git</code>， <code>oh-my-zsh</code>先。 前两者不用介绍了， 安装自己Google（还是不要百度了）。<code>oh-my-zsh</code>安装参考：<a href="http://ohmyz.sh/" target="_blank" rel="external">oh-my-zsh官网</a>,  <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Installing-ZSH" target="_blank" rel="external">安装文档</a></p>
<h3 id="步骤如下"><a href="#步骤如下" class="headerlink" title="步骤如下"></a>步骤如下</h3><p>1.安装<code>git-open</code></p>
<blockquote>
<p>(sudo) npm i git-open -g</p>
</blockquote>
<p>2.注册 git-open 命令到<code>~/.zshrc</code>文件夹下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Which plugins would you like to load? (plugins can be found in ~/.oh-my-zsh/plugins/*)</div><div class="line"># Custom plugins may be added to ~/.oh-my-zsh/custom/plugins/</div><div class="line"># Example format: plugins=(rails git textmate ruby lighthouse)</div><div class="line"># Add wisely, as too many plugins slow down shell startup.</div><div class="line">plugins=(git git-open)</div></pre></td></tr></table></figure>
<p>3.如果你的项目是gitlab项目， 那么在项目根目录文件夹下，执行如下命令：</p>
<blockquote>
<p>git config [–global] gitopen.gitlab.domain gilab.xxx.com</p>
</blockquote>
<p>4.进入项目目录，执行</p>
<blockquote>
<p>git open </p>
</blockquote>
<p>done！</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[webpack常用配置详解]]></title>
      <url>/2016/10/19/webpack-settings/</url>
      <content type="html"><![CDATA[<h2 id="1-webpack简介"><a href="#1-webpack简介" class="headerlink" title="1. webpack简介"></a>1. webpack简介</h2><p><strong>webpack 是一个模块打包工具</strong>。它使得模块相互依赖并且可构建等价于这些模块的静态资源。相比于已经存在的模块打包器（module bundler），webpack的开发动机是实现代码分包（<a href="http://webpack.github.io/docs/code-splitting.html" target="_blank" rel="external">Code Splitting</a> ）和通过模块化完成代码的无缝集成。webpack可以根据项目需求合并代码，并且支持按需加载。</p>
<p>webpack入门，可以参看：petehunt的<a href="http://www.h-simon.com/?p=9" target="_blank" rel="external">Webpack howto</a></p>
<p><strong>webpack的实现目标是：</strong></p>
<ul>
<li>拆分依赖树（dependency tree）为多个按需加载的chunk</li>
<li>保证快速首屏加载</li>
<li>每种静态资源都可成为模块</li>
<li>能够将第三方库视作一个模块来处理</li>
<li>能够定制模块打包器的几乎任何部分</li>
<li>适合大型项目</li>
</ul>
<p><img src="http://7xlcmt.com1.z0.glb.clouddn.com/15-9-22/25059073.jpg" alt=""></p>
<h2 id="2-webpack基本使用"><a href="#2-webpack基本使用" class="headerlink" title="2. webpack基本使用"></a>2. webpack基本使用</h2><p>安装webpack之前，请确认node已经安装完毕，且npm包管理器可用。</p>
<h3 id="2-1-全局安装webpack"><a href="#2-1-全局安装webpack" class="headerlink" title="2.1 全局安装webpack"></a>2.1 全局安装webpack</h3><pre><code>npm  install  webpack -g
</code></pre><h3 id="2-2-全局安装-webpack-dev-server"><a href="#2-2-全局安装-webpack-dev-server" class="headerlink" title="2.2 全局安装 webpack-dev-server"></a>2.2 全局安装 webpack-dev-server</h3><pre><code>npm install webpack-dev-server -g
</code></pre><h3 id="2-3-项目搭建"><a href="#2-3-项目搭建" class="headerlink" title="2.3 项目搭建"></a>2.3 项目搭建</h3><p>在项目的根目录下运行：</p>
<pre><code>npm install webpack
</code></pre><p>在项目根目录下新建webpack.config.js。我们通过这个文件来处理控制webpack，给出我们想要的输出。<br><img src="http://7xlcmt.com1.z0.glb.clouddn.com/15-9-22/39744580.jpg" alt=""></p>
<p><strong><code>webpack.config.js</code>的简单的配置如下：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">context</span>: __dirname + <span class="string">'/src'</span>,</div><div class="line">    <span class="attr">entry</span>: <span class="string">'./index/index.js'</span>,</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: __dirname + <span class="string">'/build'</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-4-开发调试"><a href="#2-4-开发调试" class="headerlink" title="2.4 开发调试"></a>2.4 开发调试</h3><p>项目根目录运行：</p>
<pre><code>webpack-dev-server --progress --colors
</code></pre><p>此时，访问： <a href="http://localhost:8080/index.bundle.js" target="_blank" rel="external">http://localhost:8080/index.bundle.js</a> 即可访问到编译之后的js了。</p>
<h3 id="2-5-产品发布"><a href="#2-5-产品发布" class="headerlink" title="2.5 产品发布"></a>2.5 产品发布</h3><p>通过webpack打包发布，运行：</p>
<pre><code>webpack -p
</code></pre><p>按照我们上面的<code>webpack.config.js</code>文件的配置，打包成功之后会生成一个build文件夹，里面会包含打包好的js文件，集成了所有的依赖库和业务逻辑代码，我们只需将此build文件夹发布到线上即可。</p>
<p>至此一个完整流程的webpack运行流程梳理完毕，当然webpack还有很多功能来实现我们开发中所遇到的各种变态需求，在第三章中我抽出了一些项目中常用的功能。</p>
<h2 id="3-常用功能"><a href="#3-常用功能" class="headerlink" title="3. 常用功能"></a>3. 常用功能</h2><h3 id="3-1-设置入口"><a href="#3-1-设置入口" class="headerlink" title="3.1 设置入口"></a>3.1 设置入口</h3><p>配置那些js需要处理，<code>entry</code>有三种写法，每个入口称为一个chunk。</p>
<ul>
<li><p><strong>字符串：</strong><br><code>entry: &quot;./index/index.js&quot;</code> ：配置模块会被解析为模块，并在启动时加载。chunk名为默认为<code>main</code>， 具体打包文件名视<code>output</code>配置而定。</p>
</li>
<li><p><strong>数组</strong><br><code>entry: [&#39;./src/mod1.js&#39;, [...,] &#39;./src/index.js&#39;]</code> ：所有的模块会在启动时 <strong>按照配置顺序</strong> 加载，合并到最后一个模块会被导出。chunk名默认为<code>main</code></p>
</li>
<li><p><strong>对象</strong><br><code>entry: {index: &#39;...&#39;, login : [...] }</code>：如果传入Object，则会生成多个入口打包文件， key是chunk名，value可以是字符串，也可是数组。</p>
</li>
</ul>
<p><strong>例如</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">entry: &#123;</div><div class="line">	index: &apos;./index/index.js&apos;,</div><div class="line">	login: [&apos;./mod/mod1.js&apos;, &apos;./index/login.js&apos;]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3-2-配置输出目录"><a href="#3-2-配置输出目录" class="headerlink" title="3.2 配置输出目录"></a>3.2 配置输出目录</h3><p>设置入口配置的文件的输出规则，通过<code>output</code>对象实现，常用设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">output: &#123;</div><div class="line">	<span class="attr">path</span>: __dirname + <span class="string">'/build'</span>,</div><div class="line">	<span class="attr">filename</span>: <span class="string">'[name]-[id].js'</span>,</div><div class="line">	<span class="attr">publicPath</span>: <span class="string">'/asstes/'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>其中：</strong></p>
<ul>
<li><code>output.path</code> ：指定输出文件路径，通常设置为__dirname + ‘/build’,</li>
<li><p><code>output.filename</code>: 输出文件名称，有下面列出的四种可选的变量。 filename项的配置可以是这几种的任意一种或多种的组合。 如 output.filename = ‘[name]-[id].js’, 则输出就是 index-1.js、 login-2.js。</p>
<ul>
<li><code>[id]</code>, chunk的id</li>
<li><code>[name]</code> ,chunk名</li>
<li><code>[hash]</code>, 编译哈希值</li>
<li><code>[chunkhash]</code> , chunk的hash值</li>
</ul>
</li>
<li><p><code>output.publicPath</code>：设置为想要的资源访问路径。访问时，则需要通过类似 <code>http://localhost:8080/asstes/index-1.js</code>来访问资源，如果没有设置，则默认从站点根目录加载。</p>
</li>
</ul>
<h3 id="3-3-设置loader"><a href="#3-3-设置loader" class="headerlink" title="3.3 设置loader"></a>3.3 设置loader</h3><p>loader是webpack中比较重要的部分，她是处理各类资源的执行者。它们是一系列的函数（运行在node.js中），将资源中的代码作为参数，然后返回新的代码。你可以用loader告诉webpack可以加载哪些文件，或者不加载哪些文件。</p>
<p><strong>Loader的特点</strong></p>
<ul>
<li>可以链式执行。它们在一个管道中被提交，只需要保证最后的loader返回JavaScript即可，其他loader可以返回任意方便下一个loader处理的内容。</li>
<li>可以异步or同步执行</li>
<li>运行在Node.js中，可以做几乎任何事儿</li>
<li>可以接收query参数，用于向loader传递参数</li>
<li>配置中可与正则/扩展结合使用</li>
<li>可以在npm中发布并使用</li>
<li>除了main,其他模块可以导出成loader</li>
<li>可以通过配置调入</li>
<li>和插件（plugins）配合可获得更多功能</li>
<li>可生成其他格式文件</li>
</ul>
<p><strong>安装loader</strong></p>
<pre><code>npm install xxx-loader --save
</code></pre><p>或者</p>
<pre><code>npm install xxx-loader --save-dev
</code></pre><p>其中，XXX为webpack支持的loader名，常用的有：html、css、jsx、coffee、jade、less、sass、style等。<br>你可以通过<a href="http://webpack.github.io/docs/list-of-loaders.html" target="_blank" rel="external">webpack loader 列表</a> 查看所有支持的loader。当然你可以自己根据需求创建并发布loader。</p>
<p><strong>配置loader</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">modules: &#123;</div><div class="line">	<span class="attr">loaders</span>: [</div><div class="line">		&#123;</div><div class="line">			<span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="comment">//匹配希望处理文件的路径</span></div><div class="line">			exclude: <span class="regexp">/node_modules/</span>, <span class="comment">// 匹配不希望处理文件的路径</span></div><div class="line">			loaders: <span class="string">'xxx-loader?a=x&amp;b=y'</span>  <span class="comment">//此处xxx-loader 可以简写成xxx , ？后以query方式传递给loader参数</span></div><div class="line">		&#125;,</div><div class="line">		...</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>多loader调用示例:</em></strong></p>
<p>在js中，如果要直接解析某个文件，你可以采用：</p>
<pre><code>require(&apos;jade!./index.jade&apos;)
</code></pre><p>如果要解析css，并内联之，需要使用到分隔符 <code>!</code></p>
<pre><code>require(!style!css!./style.css)
</code></pre><p>同理，如果要解析less， 转换成css之后，再内联之，写法如：</p>
<pre><code>require(&apos;!style!css!less!./style.less!&apos;) ; // 此语句的含义是，先调用less-loader解析style.less文件，输出结果会被css-loader处理, 然后再被style-loader处理
</code></pre><p>同理，在webpack.config.jsp配置文件中，只需要制定处理的loader序列：<br>即：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">loaders: [</div><div class="line">	&#123;</div><div class="line">            <span class="attr">test</span>: <span class="regexp">/\.less$/</span>,</div><div class="line">            <span class="attr">loader</span>: <span class="string">"style!css!less"</span></div><div class="line">        &#125;</div><div class="line">]</div><div class="line">...</div></pre></td></tr></table></figure>
<p>本章会介绍比较常用的loader的配置方法。</p>
<h4 id="3-3-1-解析并抽取css"><a href="#3-3-1-解析并抽取css" class="headerlink" title="3.3.1 解析并抽取css"></a>3.3.1 解析并抽取css</h4><p>在webpack中css默认方案是，将css编译并通过内联的方式在html页面中插入<code>&lt;style&gt;</code>样式标签。当然这远远不能满足我们的要求，webpack提供css-loader模块用于编译css文件，并且提供了插件<code>extract-text-webpack-plugin</code>将css从js代码中抽出并合并。你可以访问<a href="https://github.com/webpack/extract-text-webpack-plugin" target="_blank" rel="external">此处</a>,查看文档和例子。<br>这样你可以在模块中，尽情使用 <code>require(style.css)</code>, webpack会帮你做解析，合并entry中定义js及其依赖中所用到的所有css，然后生成一个指定的css文件。</p>
<p><strong>配置如下：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"></div><div class="line">...</div><div class="line">module: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</div><div class="line">            <span class="attr">loader</span>: ExtractTextPlugin.extract(</div><div class="line">                <span class="string">"style-loader"</span>,</div><div class="line">                <span class="string">"css-loader?sourceMap"</span></div><div class="line">            )</div><div class="line">        &#125;, &#123;</div><div class="line">            <span class="attr">test</span>: <span class="regexp">/\.less$/</span>,</div><div class="line">            <span class="attr">loader</span>: ExtractTextPlugin.extract(<span class="string">"style-loader"</span>, <span class="string">"css-loader!less-loader"</span>)</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line"></div><div class="line">&#125;,</div><div class="line"><span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"css/[name].css?[hash]-[chunkhash]-[contenthash]-[name]"</span>, &#123;</div><div class="line">        <span class="attr">disable</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">allChunks</span>: <span class="literal">true</span></div><div class="line">    &#125;)</div><div class="line">]</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="3-3-2-处理图片、字体等文件"><a href="#3-3-2-处理图片、字体等文件" class="headerlink" title="3.3.2 处理图片、字体等文件"></a>3.3.2 处理图片、字体等文件</h4><p>在css中或者js逻辑中，都会涉及到require图片的情况，webpack可以内联图片地址到打包js中并且通过<code>require()</code>返回图片路径。当然，不只是图片，还有css中用到的iconfont，特殊情况用到的flash等，都可以相似处理。这里，我们需要用到url-loader 或 file-loader。</p>
<ul>
<li><code>file-loader</code>:  将匹配到的文件复制到输出文件夹，并根据output.publicPath的设置返回文件路径</li>
<li><code>url-loader</code>: 类似file-loader ,但是它可以返回一个DataUrl (base 64)如果文件小于设置的限制值<code>limit</code>。</li>
</ul>
<p>同样，这之前，你需要实现配置相关loader。</p>
<p>安装<code>url-loader</code> 和 <code>file-loader</code>:</p>
<pre><code>npm install url-loader file-loader --save
</code></pre><p>配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>:&#123;</div><div class="line">	<span class="attr">loaders</span>:[</div><div class="line">		&#123;</div><div class="line">			<span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,</div><div class="line">			<span class="attr">loader</span>: <span class="string">'url-loader?limit=8192'</span> <span class="comment">//  &lt;= 8kb的图片base64内联</span></div><div class="line">		&#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.woff(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10000&amp;minetype=application/font-woff'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.woff2(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=application/font-woff'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.ttf(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=application/octet-stream'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.eot(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'file'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.svg(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=image/svg+xml'</span></div><div class="line">            &#125;</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过向url-loader传递参数，如果图片小于8kb，则base64内联，大于8kb，则通过output.publishPath配置的前缀将图片路径写入代码，并提取图片到输出目录。</p>
<h4 id="3-3-3-解析JSX"><a href="#3-3-3-解析JSX" class="headerlink" title="3.3.3 解析JSX"></a>3.3.3 解析JSX</h4><p>在React项目中，需要解析JSX和相关JavaScript文件，需要下载loader：</p>
<pre><code>npm install react-hot-loader jsx-loader --save
</code></pre><p>同样，配置loader:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"> loaders: [</div><div class="line">       &#123;</div><div class="line">           <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">           <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">           <span class="attr">loader</span>: <span class="string">'react-hot!jsx-loader?harmony'</span></div><div class="line">       &#125;</div><div class="line">   ]</div><div class="line">   ...</div></pre></td></tr></table></figure>
<h4 id="3-3-4解析VUE"><a href="#3-3-4解析VUE" class="headerlink" title="3.3.4解析VUE"></a>3.3.4解析VUE</h4><p>和React项目类似，如果要解析VUE框架编写的.vue文件，需要下载laoder:</p>
<pre><code>npm install vue-loader --save
</code></pre><p>配置loader:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">loaders: [</div><div class="line">  &#123;</div><div class="line">      <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>,</div><div class="line">      <span class="attr">loader</span>: <span class="string">'vue-loader'</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>但需要注意的是，如果你的代码中用到了如jade，less等其他语法，可能需要提前下载相应loader到本地。vue-loader的介绍可以查看： <a href="https://www.npmjs.com/package/vue-loader" target="_blank" rel="external">vue-loader</a></p>
<h4 id="3-3-5-解析ES6语法"><a href="#3-3-5-解析ES6语法" class="headerlink" title="3.3.5 解析ES6语法"></a>3.3.5 解析ES6语法</h4><p><code>babel</code>可以让我们在编写代码的时候，使用更高级的<code>ECMAScript6</code>的语法。然后我们编写的JS文件可以被编译成可被低版本浏览器处理的常规代码。</p>
<p><strong>使用方法</strong><br>安装loader:</p>
<pre><code>npm install babel-loader --save
</code></pre><p>配置loader:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">loaders: [</div><div class="line">  &#123;</div><div class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">      <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">      <span class="attr">loader</span>: <span class="string">'babel'</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p><strong>例如:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">let</span> a = <span class="number">3</span>;</div><div class="line">    <span class="built_in">console</span>.log(a);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(a);</div></pre></td></tr></table></figure>
<p>解析为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">var</span> _a = <span class="number">3</span>;</div><div class="line">    <span class="built_in">console</span>.log(_a);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(a);</div></pre></td></tr></table></figure>
<h3 id="3-4-其他"><a href="#3-4-其他" class="headerlink" title="3.4 其他"></a>3.4 其他</h3><h4 id="3-4-1-借助web-modules引用外部库"><a href="#3-4-1-借助web-modules引用外部库" class="headerlink" title="3.4.1 借助web_modules引用外部库"></a>3.4.1 借助web_modules引用外部库</h4><p>有些时候，我们用到的第三方库并没有采用CommonJS或AMD规范，也没有提交到npm。这样的话，我们无法通过npm来下载，并通过<code>require()</code>来引用这些库。<br>webpack给我们提供了一个很好的实现方式。我们可以在项目根目录下，创建一个叫做web_modules的文件夹，然后将需要用到的第三方库存放在此处。那么之后，不需要做任何设置，可以在我们的逻辑代码中使用require(<br>‘xx-lib.js’)并且使用了。</p>
<p>文件组织如下：<br><img src="http://7xlcmt.com1.z0.glb.clouddn.com/15-9-22/33041877.jpg" alt=""></p>
<p>此时，我们就可以在业务逻辑中，大胆地使用web_modules中配置的库了，打包的时候，webpack会自动将web_modules中被用到的库封装。</p>
<p><strong>例如： </strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> director = <span class="built_in">require</span>(<span class="string">'director'</span>)</div><div class="line"><span class="keyword">var</span> Router = director.Router();</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="3-4-2-去除多个文件中的频繁依赖"><a href="#3-4-2-去除多个文件中的频繁依赖" class="headerlink" title="3.4.2 去除多个文件中的频繁依赖"></a>3.4.2 去除多个文件中的频繁依赖</h4><p>当我们经常使用React、jQuery等外部第三方库的时候，通常在每个业务逻辑JS中都会遇到这些库。<br>如我们需要在各个文件中都是有jQuery的<code>$</code>对象，因此我们需要在每个用到jQuery的JS文件的头部通过<code>require(&#39;jquery&#39;)</code>来依赖jQuery。 这样做非常繁琐且重复，因此webpack提供了我们一种比较高效的方法，我们可以通过在配置文件中配置使用到的变量名，那么webpack会自动分析，并且在编译时帮我们完成这些依赖的引入。</p>
<p>webpack.config.js中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line">...</div><div class="line">plugins: [</div><div class="line">   <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</div><div class="line">	   <span class="string">'Moment'</span>: <span class="string">'moment'</span>,</div><div class="line">       <span class="string">"$"</span>: <span class="string">"jquery"</span>,</div><div class="line">       <span class="string">"jQuery"</span>: <span class="string">"jquery"</span>,</div><div class="line">       <span class="string">"window.jQuery"</span>: <span class="string">"jquery"</span>,</div><div class="line">       <span class="string">"React"</span>: <span class="string">"react"</span></div><div class="line">   &#125;)</div><div class="line">]</div><div class="line">...</div></pre></td></tr></table></figure>
<p>这样，我们在JS中，就不需要引入jQuery等常用模块了，直接使用配置的这些变量，webpack就会自动引入配置的库。</p>
<h4 id="3-4-3-开发环境与发布环境配置"><a href="#3-4-3-开发环境与发布环境配置" class="headerlink" title="3.4.3 开发环境与发布环境配置"></a>3.4.3 开发环境与发布环境配置</h4><p>某些情况，我们需要在页面中输出开发调试内容，但是又不想让这些调试内容在发布的时候泄露出去，那么我们可以采用魔力变量(magic globals)来处理。</p>
<p><strong>配置文件：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> definePlugin = <span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">    <span class="attr">__DEV__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.BUILD_DEV || <span class="string">'false'</span>)),</div><div class="line">    <span class="attr">__PRERELEASE__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.BUILD_PRERELEASE || <span class="string">'true'</span>))</div><div class="line">&#125;);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">plugins: [</div><div class="line">	definePlugin</div><div class="line">]</div><div class="line">...</div></pre></td></tr></table></figure>
<p><strong>业务逻辑代码中写入</strong><br>按照下面的代码写入，我们就可以在我们自己设定的环境下进行更具针对性的调试。比如我们希望在开发环境下可以AJAX可以调试本地mock数据，然后在发布的时候，可以正常访问服务端数据。那么通过此种方式可以完全实现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (__DEV__) &#123;</div><div class="line">    <span class="built_in">console</span>.warn(<span class="string">'Extra logging'</span>);</div><div class="line">    <span class="comment">//开发环境需要进行的处理</span></div><div class="line">    <span class="comment">//...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (__PRERELEASE__) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'prerelease'</span>);</div><div class="line">    <span class="comment">//预发环境需要进行的处理</span></div><div class="line">   <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>设置环境命令</strong></p>
<p>要告诉webpack我们希望当前是什么环境，只需要在命令中写入 <code>BUILD_DEV=1 webpck</code> 那么webpack通过配置，就会将所有我们引用到的<code>__DEV__</code>变量设置为true。</p>
<p>我们可以在package.json中事先定义好命令：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">"scripts": &#123;</div><div class="line">    "dev": "BUILD_DEV=1 webpack-dev-server --progress --colors",</div><div class="line">    "build": "BUILD_PRERELEASE=1 webpack -p"</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>那么就可以避免输入冗长的命令了：</p>
<p>开发时输入：</p>
<pre><code>npm run dev
</code></pre><p>发布时输入:</p>
<pre><code>npm run build
</code></pre><h4 id="3-4-5-合并公共代码"><a href="#3-4-5-合并公共代码" class="headerlink" title="3.4.5 合并公共代码"></a>3.4.5 合并公共代码</h4><p>项目中，对于一些常用的组件，站点公用模块经常需要与其他逻辑分开，然后合并到同一个文件，以便于长时间的缓存。要实现这一功能，配置参照:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> webpack            = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> CommonsChunkPlugin = webpack.optimize.CommonsChunkPlugin;</div><div class="line"></div><div class="line">...</div><div class="line">entry: &#123;</div><div class="line">   <span class="attr">a</span>: <span class="string">'./index/a.js'</span>,</div><div class="line">   <span class="attr">b</span>: <span class="string">'./idnex/b.js'</span>,</div><div class="line">   <span class="attr">c</span>: <span class="string">'./index/c.js'</span>,</div><div class="line">   <span class="attr">d</span>: <span class="string">'./index/d.js'</span></div><div class="line">&#125;,</div><div class="line">...</div><div class="line">plugins: [</div><div class="line">   <span class="keyword">new</span> CommonsChunkPlugin(<span class="string">'part1.js'</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]),</div><div class="line">   <span class="keyword">new</span> CommonsChunkPlugin(<span class="string">'common.js'</span>, [<span class="string">'part1'</span>, <span class="string">'c'</span>])</div><div class="line">]</div><div class="line">...</div></pre></td></tr></table></figure>
<p>##4 使用devtool调试</p>
<p>可以通过在配置中加入<code>devtool</code>项，选择预设调试工具来提高代码调试质量和效率：</p>
<ul>
<li><code>eval</code> - 每个模块采用<code>eval</code>和 <code>//@ sourceURL</code> 来执行</li>
<li><code>source-map</code> - sourceMap是发散的，和<code>output.sourceMapFilename</code>协调使用</li>
<li><code>hidden-source-map</code> - 和source-map类似，但是不会添加一个打包文件的尾部添加引用注释</li>
<li><code>inline-source-map</code>  - SourceMap以DataUrl的方式插入打包文件的尾部</li>
<li><code>eval-source-map</code> - 每个模块以eval方式执行并且SourceMap以DataUrl的方式添加进eval</li>
<li><code>cheap-source-map</code> - 去除<code>column-mappings</code>的SourceMap， 来自于loader中的内容不会被使用。</li>
<li><code>cheap-module-source-map</code> - 去除<code>column-mappings</code>的SourceMap, 来自于loader中的SourceMaps被简化为单个mapping文件</li>
</ul>
<p><strong>各种模式的对比：</strong></p>
<table>
<thead>
<tr>
<th>devtool</th>
<th>构建速度</th>
<th>再次构建速度</th>
<th>支持发布版</th>
<th>质量</th>
</tr>
</thead>
<tbody>
<tr>
<td>eval</td>
<td>+++</td>
<td>+++</td>
<td>no</td>
<td>生成代码</td>
</tr>
<tr>
<td>cheap-eval-source-map</td>
<td>+</td>
<td>++</td>
<td>no</td>
<td>转换代码(lines only)</td>
</tr>
<tr>
<td>cheap-source-map</td>
<td>+</td>
<td>o</td>
<td>yes</td>
<td>转换代码(lines only)</td>
</tr>
<tr>
<td>cheap-module-eval-source-map</td>
<td>o</td>
<td>++</td>
<td>no</td>
<td>源代码 (lines only)</td>
</tr>
<tr>
<td>cheap-module-source-map</td>
<td>o</td>
<td>-</td>
<td>yes</td>
<td>源代码(lines only)</td>
</tr>
<tr>
<td>eval-source-map</td>
<td>–</td>
<td>+</td>
<td>no</td>
<td>源代码</td>
</tr>
<tr>
<td>source-map</td>
<td>–</td>
<td>–</td>
<td>yes</td>
<td>源代码</td>
</tr>
</tbody>
</table>
<h2 id="5-一个常用的配置"><a href="#5-一个常用的配置" class="headerlink" title="5. 一个常用的配置"></a>5. 一个常用的配置</h2><p>为了方便大家摘取，和补全文章中用于示例的代码片段，特将配置文件整理如下，作参考：</p>
<p><strong>配置文件:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack            = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> CommonsChunkPlugin = webpack.optimize.CommonsChunkPlugin;</div><div class="line"><span class="keyword">var</span> ExtractTextPlugin  = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//自定义"魔力"变量</span></div><div class="line"><span class="keyword">var</span> definePlugin = <span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">    <span class="attr">__DEV__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.BUILD_DEV || <span class="string">'false'</span>)),</div><div class="line">    <span class="attr">__PRERELEASE__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.BUILD_PRERELEASE || <span class="string">'false'</span>))</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="comment">//上下文</span></div><div class="line">    context: __dirname + <span class="string">'/src'</span>,</div><div class="line">    <span class="comment">//配置入口</span></div><div class="line">    entry: &#123;</div><div class="line">        <span class="attr">a</span>: <span class="string">'./view/index/index.js'</span>,</div><div class="line">        <span class="attr">b</span>: <span class="string">'./view/index/b.js'</span>,</div><div class="line">        <span class="attr">vender</span>: [<span class="string">'./view/index/c.js'</span>, <span class="string">'./view/index/d.js'</span>]</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">//配置输出</span></div><div class="line">    output: &#123;</div><div class="line">        <span class="attr">path</span>: __dirname + <span class="string">'/build/'</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">'[name].js?[hash]'</span>,</div><div class="line">        <span class="attr">publicPath</span>: <span class="string">'/assets/'</span>,</div><div class="line">        <span class="attr">sourceMapFilename</span>: <span class="string">'[file].map'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">devtool</span>: <span class="string">'#source-map'</span>,</div><div class="line">    <span class="comment">//模块</span></div><div class="line">    <span class="built_in">module</span>: &#123;</div><div class="line">        <span class="attr">loaders</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="comment">//处理javascript</span></div><div class="line">                test: <span class="regexp">/\.js$/</span>,</div><div class="line">                <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'babel'</span></div><div class="line">            &#125;, &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</div><div class="line">                <span class="attr">loader</span>: ExtractTextPlugin.extract(</div><div class="line">                    <span class="string">"style-loader"</span>,</div><div class="line">                    <span class="string">"css-loader?sourceMap"</span></div><div class="line">                )</div><div class="line">            &#125;, &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.less$/</span>,</div><div class="line">                <span class="attr">loader</span>: ExtractTextPlugin.extract(</div><div class="line">                    <span class="string">"style-loader"</span>,</div><div class="line">                    <span class="string">"css-loader!less-loader"</span></div><div class="line">                )</div><div class="line">            &#125;, &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url-loader?limit=1024'</span></div><div class="line">            &#125;, &#123;</div><div class="line">                <span class="comment">//处理vue</span></div><div class="line">                test: <span class="regexp">/\.vue$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'vue-loader'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.woff(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10000&amp;minetype=application/font-woff'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.woff2(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=application/font-woff'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.ttf(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=application/octet-stream'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.eot(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'file'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.svg(\?v=\d+\.\d+\.\d+)?$/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'url?limit=10&amp;minetype=image/svg+xml'</span></div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line"></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">plugins</span>: [</div><div class="line">        <span class="comment">//公用模块</span></div><div class="line">        <span class="keyword">new</span> CommonsChunkPlugin(<span class="string">'common.js'</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]),</div><div class="line">        <span class="comment">//设置抽出css文件名</span></div><div class="line">        <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"css/[name].css?[hash]-[chunkhash]-[contenthash]-[name]"</span>, &#123;</div><div class="line">            <span class="attr">disable</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">allChunks</span>: <span class="literal">true</span></div><div class="line">        &#125;),</div><div class="line">        <span class="comment">//定义全局变量</span></div><div class="line">        definePlugin,</div><div class="line">        <span class="comment">//设置此处，则在JS中不用类似require('./base')引入基础模块， 只要直接使用Base变量即可</span></div><div class="line">        <span class="comment">//此处通常可用做，对常用组件，库的提前设置</span></div><div class="line">        <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</div><div class="line">            <span class="attr">Moment</span>: <span class="string">'moment'</span>, <span class="comment">//直接从node_modules中获取</span></div><div class="line">            Base: <span class="string">'../../base/index.js'</span> <span class="comment">//从文件中获取</span></div><div class="line">        &#125;)</div><div class="line">    ],</div><div class="line">    <span class="comment">//添加了此项，则表明从外部引入，内部不会打包合并进去</span></div><div class="line">    externals: &#123;</div><div class="line">        <span class="attr">jquery</span>: <span class="string">'window.jQuery'</span>,</div><div class="line">        <span class="attr">react</span>: <span class="string">'window.React'</span>,</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料:"></a>参考资料:</h2><ol>
<li><a href="http://segmentfault.com/a/1190000002551952" target="_blank" rel="external">Webpack 入门指迷</a></li>
<li><a href="http://webpack.github.io/docs/" target="_blank" rel="external">Webpack官方文档</a></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[editorconfig 使用]]></title>
      <url>/2016/10/16/editorconfig/</url>
      <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>由于团队成员开发经历、熟悉的编辑器及开发习惯等的不同，在协作开发的时候往往会遇到许多因代码风格而引起的尴尬问题。比如，协作开发过程中各成员之间代码一致，只是因tab缩进，行尾换行符，多余空格等而差异导致VCS产生了冲突。</p>
<p>Editorconfig是一款帮助开发者在不同编辑器或IDE之间定义和保持代码风格的工具。它包含了两部分内容：代码风格规则定义&amp;支持此规则的一系列编辑器插件。</p>
<p>本文根据<a href="http://editorconfig.org/" target="_blank" rel="external">editorconfig</a>官网的内容，结合常规开发所能遇到的情况，为大家介绍一下其用法</p>
<h1 id="Editorconfig的特点"><a href="#Editorconfig的特点" class="headerlink" title="Editorconfig的特点:"></a>Editorconfig的特点:</h1><ul>
<li>支持一套统一的代码风格</li>
<li>跨编辑器</li>
<li>配置简单、快捷</li>
</ul>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="1-通配符匹配规则"><a href="#1-通配符匹配规则" class="headerlink" title="1.通配符匹配规则"></a>1.通配符匹配规则</h2><p><img src="/assets/img/1.png" alt=""></p>
<ul>
<li><p>[] 匹配规则是从当前目录算起;</p>
</li>
<li><p>?只能匹配且必须有    如<code>f1.js</code>、<code>f2.js</code>、<code>f12.js</code>通过f??.js只能匹配到 <code>f12.js</code>，而f**.js可以匹配到所有;</p>
</li>
<li><p>{s1,s2,s3}之间不能有空格。[{f1.js, f2.js, f3.js}] 无法匹配<code>f2.js</code>,<code>f3.js</code>;</p>
</li>
<li><p><code>*</code>和<code>**</code>可以匹配空字符串   如<code>f*.js</code>可以匹配<code>f.js</code></p>
</li>
<li><p>多个匹配之间的规则如果不冲突是可以合并的</p>
</li>
<li><p>优先级问题（有点类似于css ）</p>
<p>  如果两个匹配所定义的规则冲突，则会以最靠近打开文件的<code>.editorconfig</code>文件为准;</p>
<p>  如果同一个文件中匹配定义冲突，则会以最后定义的为准。所以在定义规则的时候，须先定义通用规则，后定义特殊规则。</p>
</li>
</ul>
<h2 id="2-支持属性"><a href="#2-支持属性" class="headerlink" title="2.支持属性"></a>2.支持属性</h2><p><img src="/assets/img/2.png" alt=""></p>
<pre><code>注：

1.所有属性设置大小写敏感，使用小写；

2.`.editorconfig`文件的使用规则：

    当打开一个文件的时候，IDE中安装的Editorconfig组件会在当前文件目录以及其父目录查找.editorconfig文件。当到达根目录或者查找到一个editorconfig文件中root=true时，停止查找。

    查找顺序从根目录（或root=true文件夹）到当前目录，最接近当前打开文件的.editorconfig会最后被读取，这些文件中所设置的属性越靠近当前打开文件，优先级越高

3.Windows中由于扩展规则限制，可通过输入&apos;.editorconfig.&apos;生成配置文件
</code></pre><h1 id="常用IDE下载链接"><a href="#常用IDE下载链接" class="headerlink" title="常用IDE下载链接"></a>常用IDE下载链接</h1><ul>
<li>Notepad++:        <a href="https://github.com/editorconfig/editorconfig-notepad-plus-plus#readme" target="_blank" rel="external">https://github.com/editorconfig/editorconfig-notepad-plus-plus#readme</a></li>
<li>Sublime Text:     <a href="https://github.com/sindresorhus/editorconfig-sublime#readme" target="_blank" rel="external">https://github.com/sindresorhus/editorconfig-sublime#readme</a></li>
<li>jetBrains:        <a href="https://github.com/editorconfig/editorconfig-jetbrains#readme" target="_blank" rel="external">https://github.com/editorconfig/editorconfig-jetbrains#readme</a></li>
<li>Vim:              <a href="https://github.com/editorconfig/editorconfig-vim#readme" target="_blank" rel="external">https://github.com/editorconfig/editorconfig-vim#readme</a></li>
<li>TextMate:         <a href="https://github.com/Mr0grog/editorconfig-textmate#readme" target="_blank" rel="external">https://github.com/Mr0grog/editorconfig-textmate#readme</a></li>
<li>Code::Blocks:     <a href="https://github.com/editorconfig/editorconfig-codeblocks#readme" target="_blank" rel="external">https://github.com/editorconfig/editorconfig-codeblocks#readme</a></li>
</ul>
<p>支持的所有编辑器列表：</p>
<p><img src="/assets/img/3.png" alt=""></p>
<h1 id="安装举例"><a href="#安装举例" class="headerlink" title="安装举例"></a>安装举例</h1><h2 id="jetbrains-包括Intellij-IDEA-和-webstrom-安装"><a href="#jetbrains-包括Intellij-IDEA-和-webstrom-安装" class="headerlink" title="jetbrains (包括Intellij IDEA 和 webstrom) 安装"></a>jetbrains (包括Intellij IDEA 和 webstrom) 安装</h2><p>1.打开settings-&gt;plugins</p>
<p><img src="/assets/img/4.png" alt=""></p>
<p>2.选择从本地磁盘安装</p>
<p><img src="/assets/img/5.png" alt=""></p>
<p>3.选择安装插件[见附件]</p>
<h2 id="sublime-text安装"><a href="#sublime-text安装" class="headerlink" title="sublime text安装"></a>sublime text安装</h2><p>通过<code>package control</code> 输入 editorcofnig 查找安装即可</p>
<p><img src="/assets/img/6.png" alt=""></p>
<h2 id="notepad-安装"><a href="#notepad-安装" class="headerlink" title="notepad ++ 安装"></a>notepad ++ 安装</h2><p>1.打开插件管理</p>
<p><img src="/assets/img/7.png" alt=""></p>
<p>2.找到<code>editorconfig</code>,直接安装即可</p>
<h1 id="editor配置示例"><a href="#editor配置示例" class="headerlink" title="editor配置示例"></a>editor配置示例</h1><p>将.editorconfig文件(内容如下)放到项目根目录，并且对自己的IDE安装相应支持的插件即可。</p>
<pre><code># editorconfig文件定义一致的code style规范
# 根据不同的开发IDE或编辑器统一代码风格
# 详情见 editorconfig.org
root = true


[*]
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true
indent_style = space
indent_size = 4
</code></pre>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[优化hexo的发布代码]]></title>
      <url>/2016/10/09/hexo-gulpfile/</url>
      <content type="html"><![CDATA[<p>我们都知道<code>hexo</code>执行<code>hexo g</code>命令之后 ，会生成<code>/public</code>文件夹， 这是我们最终将要发布到线上的最终内容。 而由于各个hexo的主题中质量不一致，让<code>/public</code>文件夹还会有一定的优化空间， 我们需要对此文件夹进行一次基本的前端优化：</p>
<ul>
<li>压缩图片</li>
<li>html 压缩</li>
<li>css 压缩</li>
<li>js 压缩</li>
</ul>
<p>本文总结一个试验后的可行方法。</p>
<h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><p>建议安装淘宝的<a href="https://npm.taobao.org/" target="_blank" rel="external">cnpm</a>提速。</p>
<blockquote>
<p>(c)npm i gulp gulp gulp-uglify gulp-minify-css gulp-htmlmin gulp-minify-inline gulp-imagemin –save-dev</p>
</blockquote>
<h2 id="创建gulpfile-js"><a href="#创建gulpfile-js" class="headerlink" title="创建gulpfile.js"></a>创建gulpfile.js</h2><p>在hexo blog文件夹下创建<code>gulpfile.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span></div><div class="line">  gulp         = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</div><div class="line">  uglify       = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>),</div><div class="line">  cssmin       = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>),</div><div class="line">  htmlmin      = <span class="built_in">require</span>(<span class="string">'gulp-htmlmin'</span>),</div><div class="line">  minifyInline = <span class="built_in">require</span>(<span class="string">'gulp-minify-inline'</span>),</div><div class="line">  imagemin     = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</div><div class="line"></div><div class="line"><span class="comment">//JS压缩</span></div><div class="line">gulp.task(<span class="string">'uglify'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'././public/**/*.js'</span>)</div><div class="line">    .pipe(uglify())</div><div class="line">    .pipe(gulp.dest(<span class="string">'././public/'</span>));</div><div class="line">&#125;);</div><div class="line"><span class="comment">//CSS压缩</span></div><div class="line">gulp.task(<span class="string">'cssmin'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'././public/**/*.css'</span>)</div><div class="line">    .pipe(cssmin())</div><div class="line">    .pipe(gulp.dest(<span class="string">'././public/'</span>));</div><div class="line">&#125;);</div><div class="line"><span class="comment">//图片压缩</span></div><div class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  gulp.src(<span class="string">'././public/*.*'</span>)</div><div class="line">    .pipe(imagemin(&#123;</div><div class="line">      <span class="attr">progressive</span>: <span class="literal">false</span></div><div class="line">    &#125;))</div><div class="line">    .pipe(gulp.dest(<span class="string">'././public/'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//html压缩</span></div><div class="line">gulp.task(<span class="string">'htmlmin'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'././public/**/*.html'</span>)</div><div class="line">    .pipe(htmlmin(&#123;<span class="attr">collapseWhitespace</span>: <span class="literal">true</span>&#125;))</div><div class="line">    .pipe(minifyInline())</div><div class="line">    .pipe(gulp.dest(<span class="string">'././public/'</span>));</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(<span class="string">'build'</span>, [<span class="string">'uglify'</span>, <span class="string">'cssmin'</span>, <span class="string">'images'</span>, <span class="string">'htmlmin'</span>]);</div></pre></td></tr></table></figure>
<h2 id="执行优化命令"><a href="#执行优化命令" class="headerlink" title="执行优化命令"></a>执行优化命令</h2><p>清空hexo public文件夹</p>
<blockquote>
<p>hexo clean<br>hexo g<br>gulp build</p>
</blockquote>
<p>连续执行3个命令太麻烦， 可以直接在<code>package.json</code>文件中生成写入<code>scripts</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"build"</span>: <span class="string">"hexo clean &amp;&amp; hexo g &amp;&amp; gulp build"</span></div><div class="line">&#125;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>然后直接执行如下命令就可以了</p>
<blockquote>
<p>npm run build</p>
</blockquote>
<p>至此，可以得到一个html、css、js、image都更优化的<code>/public</code>文件夹，最后再用各种评测工具测试一下你的博客打开速度吧！~</p>
]]></content>
    </entry>
    
  
  
</search>
